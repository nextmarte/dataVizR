---
title: Visualização de dados com R
subtitle: Aula 1 - Introdução a visualização de dados
author: Marcus Ramalho
format: 
    revealjs: 
        incremental: true  
        transition: slide
        background-transition: fade
        theme: dark
date: today
footer: Universidade Federal Fluminense - Programa de formação de executivos - Ciência de dados
---

```{r}
library(tidyverse)
```

## O curso {auto-animate=true}

Aula 1

-   Gráficos no R base, plot, hist, boxplot
-   Escalas Logarítmicas e Lineares
-   Tipos de Gráficos por Tipo de Variável
-   gramática dos gráficos e ggplot2
    -   cores, formas, tamanhos
    -   Facets
    -   Rótulos, títulos e temas
-   EDA com o pacote esquisse
-   Exercícios de fixação
-   Tarefa com nota

## Gráficos no R base - plot

```{r}
#| echo: true

plot(iris$Sepal.Length, iris$Sepal.Width,
    col = iris$Species, pch = 19,
    xlab = "Comprimento", ylab = "Largura", main = "Comprimento x Largura da Sépala"
)

# Legenda
legend(
    "topright",
    legend = levels(iris$Species),
    col = c("black", "red", "green"),
    pch = 19,
    title = "Espécies",
    bg = "lightgray"
)
```

## Gráficos no R base - hist

```{r}
#| echo: true
hist(iris$Sepal.Length,
    xlab = "Comprimento da Sépala",
    ylab = "Frequência",
    main = "Histograma do Comprimento da Sépala",
    col = "lightblue",
    border = "black"
)
```

## Gráficos no R base - boxplot

```{r}
#| echo: true

boxplot(iris$Sepal.Length,
    xlab = "Espécies",
    ylab = "Comprimento da Sépala",
    main = "Gráfico de Caixa do Comprimento da Sépala",
    col = "lightblue",
    border = "black"
)
```

## Gráficos no R base - barplot

```{r}
#| echo: true

barplot(table(iris$Species),
    xlab = "Espécies",
    ylab = "Contagem",
    main = "Gráfico de Barras das Espécies",
    col = "lightblue",
    border = "black"
)
```

## Gráficos no R base - pie

```{r}
#| echo: true
pie(table(iris$Species),
    main = "Gráfico de Pizza das Espécies",
    col = c("lightblue", "lightgreen", "lightpink"),
    border = "black"
)
```


## Escalas contínuas e discretas

As escalas controlam a forma como os dados são mapeados para os aspectos visuais do gráfico. 

```{r}
url <- "https://tinyurl.com/mtktm8e5"
insurance <- read.csv(url)
# modify the x and y axes and specify the colors to be used
ggplot(
    data = insurance,
    mapping = aes(
        x = age,
        y = expenses,
        color = smoker
    )
) +
    geom_point(
        alpha = .5,
        size = 2
    ) +
    geom_smooth(
        method = "lm",
        se = FALSE,
        size = 1.5
    ) +
    scale_x_continuous(breaks = seq(0, 70, 10)) +
    scale_y_continuous(
        breaks = seq(0, 60000, 20000),
        label = scales::dollar
    ) +
    scale_color_manual(values = c(
        "indianred3",
        "cornflowerblue"
    ))
```


## Escalas Lineares e Logarítmicas

:::{layout-ncol=2}

```{r}
#| echo: true

x <- seq(1, 100, 1)
y <- x^2

plot(x, y, type = "l", col = "blue", lwd = 2, xlab = "X", ylab = "Y", main = "Gráfico com Escala Linear")
```

-  Escalas lineares são as mais comuns
-  Representam a relação entre duas variáveis de forma proporcional
-  Dados variam de forma linear

:::

## Escalas Lineares e Logarítmicas

:::{layout-ncol=2}

Exemplo de gráfico com escala logarítmica

```{r}
#| echo: true

# Dados
x <- seq(1, 100, 1)
y <- exp(x)

# Gráfico com escala logarítmica no eixo y
plot(x, y,
    type = "l", col = "blue", lwd = 2,
    xlab = "X", ylab = "Y (log scale)",
    main = "Gráfico com Escala Logarítmica",
    log = "y"
)
```

## Tipo de Gráficos por Tipo de Variável

-   Variáveis categóricas
    -   barras
    -   setor
    -   etc...
-   Variáveis numéricas
    -   Histograma
    -   boxplot
    -   Gráfico de dispersão
    -   etc...
  
## Tipo de Gráficos por Tipo de Variável

Ferramentas úteis: 

```{=html}
<iframe width="1120" height="500" src="https://www.data-to-viz.com/" title="Webpage example"></iframe>
```

## Gramática dos gráficos e ggplot2

O que é a gramática dos gráficos?

-   É um conjunto de regras que descrevem a estrutura de um gráfico e como ele é construído a partir dos dados.
-   O ggplot2 é um pacote do R que implementa a gramática dos gráficos.

## ggplot2 - Exemplo
  
```{r}  
#| echo: true
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
    geom_point() +
    labs(title = "Comprimento x Largura da Sépala", x = "Comprimento", y = "Largura") +
    theme_minimal()
```

## ggplot2 - Elementos da gramática


```{r}

# Dados: Este é o conjunto de dados que queremos visualizar.
data <- mtcars

# Aesthetics: Mapeia variáveis nos dados para aspectos visuais do gráfico.
aes <- aes(x = mpg, y = hp)

# Geometrias: Descreve o tipo de gráfico que queremos criar.
geom <- geom_point()

# Escalas: Controla como os dados são mapeados para os aspectos visuais do gráfico.
scale <- scale_y_log10()

# Facets: Permite criar múltiplos gráficos pequenos, cada um mostrando um subconjunto dos dados.
facet <- facet_wrap(~cyl)

# Estatísticas: Realiza cálculos nos dados.
stat <- stat_summary(fun = mean, geom = "point", color = "red", size = 3)

# Coordenadas: Define o sistema de coordenadas do gráfico.

# Tema: Controla a aparência não-dados do gráfico, como a cor de fundo e a fonte do texto.
theme <- theme_minimal()

# Títulos e legendas
labels <- labs(
    title = "Relação entre MPG e HP",
    x = "MPG",
    y = "HP (escala logarítmica)",
    color = "Número de cilindros"
)

# Criar o gráfico
ggplot(data, aes) + geom + scale + facet + stat + theme + labels

```

## ggplot2 - Elementos da gramática


```{r}
#| echo: true
#| eval: false

# Dados: Este é o conjunto de dados que queremos visualizar.
data <- mtcars

# Aesthetics: Mapeia variáveis nos dados para aspectos visuais do gráfico.
aes <- aes(x = mpg, y = hp)

# Geometrias: Descreve o tipo de gráfico que queremos criar.
geom <- geom_point()

# Escalas: Controla como os dados são mapeados para os aspectos visuais do gráfico.
scale <- scale_y_log10()

# Facets: Permite criar múltiplos gráficos pequenos, cada um mostrando um subconjunto dos dados.
facet <- facet_wrap(~cyl)

# Estatísticas: Realiza cálculos nos dados.
stat <- stat_summary(fun = mean, geom = "point", color = "red", size = 3)

# Coordenadas: Define o sistema de coordenadas do gráfico.

# Tema: Controla a aparência não-dados do gráfico, como a cor de fundo e a fonte do texto.
theme <- theme_minimal()

# Títulos e legendas
labels <- labs(
    title = "Relação entre MPG e HP",
    x = "MPG",
    y = "HP (escala logarítmica)",
    color = "Número de cilindros"
)

# Criar o gráfico
ggplot(data, aes) + geom + scale + facet + stat + theme + labels

```

## ggplot2 - Elementos da gramática


```{r}
#| echo: true
#| eval: false

# Criar o gráfico
ggplot(mtcars, aes(x = mpg, y = hp)) +
    geom_point() +
    scale_y_log10() +
    facet_wrap(~cyl) +
    stat_summary(fun = mean, geom = "point", color = "red", size = 3) +
    theme_minimal() +
    labs(
        title = "Relação entre MPG e HP",
        x = "MPG",
        y = "HP (escala logarítmica)",
        color = "Número de cilindros"
    )

```